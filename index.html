<!--
[JST 2026-01-03 17:00]  okurigana_fall_game_single.html
スマホ向け・画像なし・送り仮名×落ちゲー（3レーン）
操作:
  - 画面を左右スワイプ: レーン移動
  - 下の3つの選択肢ボタンをタップ: そのレーンへ移動
ルール:
  - 上から「漢字＋空欄」が落ちてくる
  - 下の3レーンに表示された候補（かな）から、正しい送り仮名のレーンに入って受ける
  - 正解でスコア/コンボ、誤答でライフ減。ライフ0でゲームオーバー
-->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>送り仮名 落ちゲー</title>
  <style>
    /* [CSS-01] ベース */
    :root{
      --bg:#0e1326;
      --panel:rgba(255,255,255,0.06);
      --panel2:rgba(255,255,255,0.10);
      --line:rgba(255,255,255,0.18);
      --text:rgba(255,255,255,0.92);
      --muted:rgba(255,255,255,0.68);
      --ok:rgba(120,170,255,0.95);
      --ng:rgba(255,90,120,0.95);
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --radius:16px;
      --btnRadius:18px;
      --shadow: 0 18px 55px rgba(0,0,0,0.35);
    }
    html, body{
      height:100%;
      margin:0;
      background:
        radial-gradient(1000px 600px at 20% 10%, rgba(120,170,255,0.14), transparent 55%),
        radial-gradient(900px 600px at 90% 25%, rgba(255,90,120,0.10), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif;
      -webkit-tap-highlight-color: transparent;
      overscroll-behavior: none;
      user-select:none;
    }

    /* [CSS-02] レイアウト（上:HUD / 中:フィールド / 下:選択肢） */
    .app{
      height:100%;
      display:grid;
      grid-template-rows: auto 1fr auto;
      gap:10px;
      padding-top: calc(10px + var(--safe-top));
      padding-bottom: calc(10px + var(--safe-bottom));
    }

    .hud{
      margin:0 12px;
      padding:12px 12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel2), var(--panel));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow);
      display:grid;
      grid-template-columns: 1fr auto;
      align-items:center;
      gap:10px;
    }
    .hudLeft .title{
      font-size:15px;
      font-weight:800;
      letter-spacing:0.3px;
      line-height:1.2;
    }
    .hudLeft .sub{
      margin-top:4px;
      font-size:12px;
      color:var(--muted);
      line-height:1.2;
    }
    .hudRight{
      display:grid;
      gap:6px;
      text-align:right;
      font-variant-numeric: tabular-nums;
    }
    .hudRight .row{
      font-size:12px;
      color:var(--muted);
    }
    .hudRight .row b{
      color:var(--text);
      font-size:14px;
      margin-left:8px;
      font-weight:900;
    }

    .field{
      margin:0 12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
      min-height: 380px;
    }

    /* 3レーンの境界線（見た目） */
    .laneLine{
      position:absolute;
      top:0; bottom:0;
      width:1px;
      background: rgba(255,255,255,0.10);
      pointer-events:none;
    }

    /* キャッチライン */
    .catchLine{
      position:absolute;
      left:0; right:0;
      height:2px;
      background: rgba(120,170,255,0.35);
      bottom: 92px; /* 下部ボタンの上に合わせる */
      pointer-events:none;
    }
    .catchLabel{
      position:absolute;
      right:10px;
      bottom: calc(92px + 8px);
      font-size:11px;
      color: rgba(120,170,255,0.9);
      background: rgba(0,0,0,0.20);
      border:1px solid rgba(120,170,255,0.25);
      padding:4px 8px;
      border-radius:999px;
      pointer-events:none;
    }

    /* 落下問題（文字ブロック） */
    .falling{
      position:absolute;
      top:0;
      width: 30%;
      left: 35%;
      transform: translateX(0);
      text-align:center;
      pointer-events:none;
    }
    .card{
      display:inline-grid;
      gap:6px;
      padding:12px 10px;
      border-radius:14px;
      background: rgba(0,0,0,0.22);
      border:1px solid rgba(255,255,255,0.12);
      backdrop-filter: blur(4px);
    }
    .qText{
      font-size:30px;
      font-weight:900;
      letter-spacing:1px;
      line-height:1.0;
    }
    .qHint{
      font-size:11px;
      color:var(--muted);
      letter-spacing:0.2px;
    }

    /* プレイヤー（下部の受け位置） */
    .player{
      position:absolute;
      bottom: 92px; /* キャッチライン位置に合わせる */
      width: 30%;
      height: 46px;
      left: 35%;
      display:grid;
      place-items:center;
      pointer-events:none;
    }
    .playerInner{
      width: 78%;
      height: 34px;
      border-radius: 999px;
      background: rgba(120,170,255,0.16);
      border: 1px solid rgba(120,170,255,0.35);
      box-shadow: 0 12px 30px rgba(120,170,255,0.10);
      display:grid;
      place-items:center;
      font-weight:900;
      letter-spacing:0.3px;
      color: rgba(210,230,255,0.95);
      font-size: 13px;
    }

    /* フィードバック（正解/不正解） */
    .toast{
      position:absolute;
      left:50%;
      top: 14px;
      transform: translateX(-50%);
      padding:10px 14px;
      border-radius:999px;
      background: rgba(0,0,0,0.22);
      border:1px solid rgba(255,255,255,0.12);
      color: var(--text);
      font-size:13px;
      font-weight:900;
      opacity:0;
      pointer-events:none;
    }
    .toast.show{
      opacity:1;
      animation: toastFade 900ms ease-out forwards;
    }
    .toast.ok{
      border-color: rgba(120,170,255,0.35);
      background: rgba(120,170,255,0.14);
    }
    .toast.ng{
      border-color: rgba(255,90,120,0.35);
      background: rgba(255,90,120,0.14);
    }
    @keyframes toastFade{
      0%{ transform: translateX(-50%) translateY(6px); opacity:0; }
      20%{ transform: translateX(-50%) translateY(0px); opacity:1; }
      100%{ transform: translateX(-50%) translateY(-10px); opacity:0; }
    }

    /* 下部: 3レーン選択肢 */
    .choices{
      margin:0 12px;
      padding:12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel2), var(--panel));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow);
      display:grid;
      gap:10px;
    }
    .choiceRow{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    .choiceBtn{
      border:none;
      border-radius: var(--btnRadius);
      padding:16px 8px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.12);
      color: var(--text);
      font-size:22px;
      font-weight:900;
      cursor:pointer;
      box-shadow: 0 14px 30px rgba(0,0,0,0.18);
    }
    .choiceBtn:active{
      transform: translateY(1px);
      filter: brightness(0.98);
    }
    .choiceBtn.active{
      outline: 2px solid rgba(120,170,255,0.55);
      background: rgba(120,170,255,0.18);
      border-color: rgba(120,170,255,0.25);
    }
    .smallRow{
      display:grid;
      grid-template-columns: 1fr auto auto;
      gap:10px;
      align-items:center;
    }
    .chip{
      font-size:12px;
      color:var(--muted);
      padding:10px 12px;
      border-radius:999px;
      background: rgba(0,0,0,0.18);
      border:1px solid rgba(255,255,255,0.10);
    }
    .miniBtn{
      border:none;
      border-radius:999px;
      padding:10px 12px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.10);
      color: var(--text);
      font-weight:800;
      cursor:pointer;
    }
    .miniBtn:active{ transform: translateY(1px); }

    /* オーバーレイ（開始/ゲームオーバー） */
    .overlay{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      background: rgba(0,0,0,0.45);
      z-index: 20;
    }
    .overlayCard{
      width:min(360px, 88%);
      border-radius:18px;
      padding:18px 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border:1px solid rgba(255,255,255,0.14);
      box-shadow: 0 30px 90px rgba(0,0,0,0.55);
      text-align:center;
    }
    .overlayCard .big{
      font-size:18px;
      font-weight:900;
      letter-spacing:0.4px;
      margin-bottom:8px;
    }
    .overlayCard .desc{
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
      margin-bottom:14px;
    }
    .startBtn{
      width:100%;
      border:none;
      border-radius: 16px;
      padding:14px 12px;
      font-size:16px;
      font-weight:900;
      color: var(--text);
      background: linear-gradient(180deg, rgba(120,170,255,0.95), rgba(80,120,255,0.82));
      box-shadow: 0 16px 34px rgba(80,120,255,0.22);
      cursor:pointer;
    }
    .startBtn:active{ transform: translateY(1px); }
  </style>
</head>

<body>
  <div class="app">

    <!-- [UI-01] 上部HUD -->
    <header class="hud" aria-label="状態">
      <div class="hudLeft">
        <div class="title">送り仮名 落ちゲー</div>
        <div class="sub">左右スワイプで移動／下の候補をタップでもOK</div>
      </div>
      <div class="hudRight">
        <div class="row">SCORE<b id="scoreTxt">0</b></div>
        <div class="row">COMBO<b id="comboTxt">0</b></div>
        <div class="row">LIFE<b id="lifeTxt">3</b></div>
      </div>
    </header>

    <!-- [UI-02] フィールド -->
    <main class="field" id="field" aria-label="フィールド">
      <div class="laneLine" id="lane1"></div>
      <div class="laneLine" id="lane2"></div>
      <div class="catchLine"></div>
      <div class="catchLabel">ここで判定</div>

      <div class="toast" id="toast"></div>

      <!-- 落下問題 -->
      <div class="falling" id="falling">
        <div class="card">
          <div class="qText" id="qText">　</div>
          <div class="qHint" id="qHint">正しい送り仮名のレーンへ</div>
        </div>
      </div>

      <!-- プレイヤー -->
      <div class="player" id="player">
        <div class="playerInner">受ける</div>
      </div>

      <!-- 開始/終了オーバーレイ -->
      <div class="overlay" id="overlay">
        <div class="overlayCard">
          <div class="big" id="overlayTitle">スタート</div>
          <div class="desc" id="overlayDesc">
            上から落ちる問題に対して、下の3候補から正しい送り仮名を選び、<br/>
            そのレーンで受けると正解です。
          </div>
          <button class="startBtn" id="startBtn">開始</button>
        </div>
      </div>
    </main>

    <!-- [UI-03] 下部選択肢 -->
    <footer class="choices" aria-label="選択肢">
      <div class="choiceRow">
        <button class="choiceBtn" id="c0">-</button>
        <button class="choiceBtn" id="c1">-</button>
        <button class="choiceBtn" id="c2">-</button>
      </div>
      <div class="smallRow">
        <div class="chip" id="statusChip">速度: 1.0x（徐々に上がります）</div>
        <button class="miniBtn" id="pauseBtn">一時停止</button>
        <button class="miniBtn" id="resetBtn">リセット</button>
      </div>
    </footer>

  </div>

  <script>
    /*
      [JS-01] データ（送り仮名）
      - display: 画面表示（空欄は【】）
      - correct: 正解のかな（空欄に入る送り仮名）
      - wrong: 誤答候補（2つ）
    */
    var QUESTIONS = [
      { display: "取【】", correct: "る", wrong: ["り","れ"] },
      { display: "使【】", correct: "う", wrong: ["い","え"] },
      { display: "動【】", correct: "く", wrong: ["き","け"] },
      { display: "落【】る", correct: "ち", wrong: ["と","つ"] },
      { display: "押【】す", correct: "し", wrong: ["す","せ"] },
      { display: "返【】す", correct: "し", wrong: ["す","せ"] },
      { display: "泳【】ぐ", correct: "ぎ", wrong: ["き","げ"] },
      { display: "急【】ぐ", correct: "ぎ", wrong: ["き","げ"] },
      { display: "続【】く", correct: "づ", wrong: ["つ","ず"] },
      { display: "片【】ける", correct: "づ", wrong: ["つ","ず"] },
      { display: "近【】い", correct: "ちか", wrong: ["ちけ","ちこ"] }, /* 例外的（語幹込み） */
      { display: "明【】い", correct: "かる", wrong: ["か