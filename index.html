<!--
[JST 2026-01-03 17:00]  okurigana_fall_game_easy_single.html
送り仮名 × 落ちゲー（簡単版 / 3択タップのみ）
操作:
  - 下の3つの候補ボタンをタップするだけ（スワイプ・移動なし）
ルール:
  - 問題が上から落ちてくる
  - 落ち切る前に正しい送り仮名（かな）をタップ → 正解
  - 間違い or タイムアウト → ライフ-1
-->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>送り仮名 落ちゲー（簡単）</title>
  <style>
    :root{
      --bg:#0e1326;
      --panel:rgba(255,255,255,0.06);
      --panel2:rgba(255,255,255,0.10);
      --text:rgba(255,255,255,0.92);
      --muted:rgba(255,255,255,0.68);
      --ok:rgba(120,170,255,0.95);
      --ng:rgba(255,90,120,0.95);
      --line:rgba(255,255,255,0.18);
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --radius:16px;
      --btnRadius:18px;
      --shadow: 0 18px 55px rgba(0,0,0,0.35);
    }
    html, body{
      height:100%;
      margin:0;
      background:
        radial-gradient(1000px 600px at 20% 10%, rgba(120,170,255,0.14), transparent 55%),
        radial-gradient(900px 600px at 90% 25%, rgba(255,90,120,0.10), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif;
      -webkit-tap-highlight-color: transparent;
      overscroll-behavior: none;
      user-select:none;
    }

    .app{
      height:100%;
      display:grid;
      grid-template-rows: auto 1fr auto;
      gap:10px;
      padding-top: calc(10px + var(--safe-top));
      padding-bottom: calc(10px + var(--safe-bottom));
    }

    /* 上部HUD */
    .hud{
      margin:0 12px;
      padding:12px 12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel2), var(--panel));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow);
      display:grid;
      grid-template-columns: 1fr auto;
      align-items:center;
      gap:10px;
    }
    .hudLeft .title{
      font-size:15px;
      font-weight:900;
      letter-spacing:0.3px;
      line-height:1.2;
    }
    .hudLeft .sub{
      margin-top:4px;
      font-size:12px;
      color:var(--muted);
      line-height:1.2;
    }
    .hudRight{
      display:grid;
      gap:6px;
      text-align:right;
      font-variant-numeric: tabular-nums;
    }
    .hudRight .row{
      font-size:12px;
      color:var(--muted);
    }
    .hudRight .row b{
      color:var(--text);
      font-size:14px;
      margin-left:8px;
      font-weight:900;
    }

    /* フィールド */
    .field{
      margin:0 12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
      min-height: 380px;
    }

    /* タイムアウト判定ライン */
    .catchLine{
      position:absolute;
      left:0; right:0;
      height:2px;
      background: rgba(255,255,255,0.10);
      bottom: 112px;
      pointer-events:none;
    }
    .catchLabel{
      position:absolute;
      right:10px;
      bottom: calc(112px + 8px);
      font-size:11px;
      color: var(--muted);
      background: rgba(0,0,0,0.20);
      border:1px solid rgba(255,255,255,0.10);
      padding:4px 8px;
      border-radius:999px;
      pointer-events:none;
    }

    /* 落下する問題カード */
    .falling{
      position:absolute;
      left:50%;
      transform: translateX(-50%);
      top: -60px;
      text-align:center;
      pointer-events:none;
      z-index: 5;
    }
    .card{
      display:inline-grid;
      gap:8px;
      padding:14px 12px;
      border-radius:16px;
      background: rgba(0,0,0,0.24);
      border:1px solid rgba(255,255,255,0.14);
      box-shadow: 0 18px 40px rgba(0,0,0,0.28);
    }
    .qText{
      font-size:34px;
      font-weight:900;
      letter-spacing:1px;
      line-height:1.0;
      white-space: nowrap;
    }
    .qHint{
      font-size:12px;
      color:var(--muted);
      letter-spacing:0.2px;
    }

    /* フィードバック */
    .toast{
      position:absolute;
      left:50%;
      top: 14px;
      transform: translateX(-50%);
      padding:10px 14px;
      border-radius:999px;
      background: rgba(0,0,0,0.22);
      border:1px solid rgba(255,255,255,0.12);
      color: var(--text);
      font-size:13px;
      font-weight:900;
      opacity:0;
      pointer-events:none;
      z-index: 10;
    }
    .toast.show{
      opacity:1;
      animation: toastFade 850ms ease-out forwards;
    }
    .toast.ok{
      border-color: rgba(120,170,255,0.35);
      background: rgba(120,170,255,0.14);
    }
    .toast.ng{
      border-color: rgba(255,90,120,0.35);
      background: rgba(255,90,120,0.14);
    }
    @keyframes toastFade{
      0%{ transform: translateX(-50%) translateY(6px); opacity:0; }
      20%{ transform: translateX(-50%) translateY(0px); opacity:1; }
      100%{ transform: translateX(-50%) translateY(-10px); opacity:0; }
    }

    /* 下部: 3択ボタン */
    .choices{
      margin:0 12px;
      padding:12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel2), var(--panel));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow: var(--shadow);
      display:grid;
      gap:10px;
    }
    .choiceRow{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    .choiceBtn{
      border:none;
      border-radius: var(--btnRadius);
      padding:18px 8px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.12);
      color: var(--text);
      font-size:26px;
      font-weight:900;
      cursor:pointer;
      box-shadow: 0 14px 30px rgba(0,0,0,0.18);
    }
    .choiceBtn:active{
      transform: translateY(1px);
      filter: brightness(0.98);
    }
    .choiceBtn.disabled{
      opacity: 0.55;
      cursor: default;
    }

    .smallRow{
      display:grid;
      grid-template-columns: 1fr auto auto;
      gap:10px;
      align-items:center;
    }
    .chip{
      font-size:12px;
      color:var(--muted);
      padding:10px 12px;
      border-radius:999px;
      background: rgba(0,0,0,0.18);
      border:1px solid rgba(255,255,255,0.10);
    }
    .miniBtn{
      border:none;
      border-radius:999px;
      padding:10px 12px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.10);
      color: var(--text);
      font-weight:900;
      cursor:pointer;
    }
    .miniBtn:active{ transform: translateY(1px); }

    /* オーバーレイ */
    .overlay{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      background: rgba(0,0,0,0.45);
      z-index: 20;
    }
    .overlayCard{
      width:min(360px, 88%);
      border-radius:18px;
      padding:18px 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border:1px solid rgba(255,255,255,0.14);
      box-shadow: 0 30px 90px rgba(0,0,0,0.55);
      text-align:center;
    }
    .overlayCard .big{
      font-size:18px;
      font-weight:900;
      letter-spacing:0.4px;
      margin-bottom:8px;
    }
    .overlayCard .desc{
      font-size:12px;
      color:var(--muted);
      line-height:1.6;
      margin-bottom:14px;
    }
    .startBtn{
      width:100%;
      border:none;
      border-radius: 16px;
      padding:14px 12px;
      font-size:16px;
      font-weight:900;
      color: var(--text);
      background: linear-gradient(180deg, rgba(120,170,255,0.95), rgba(80,120,255,0.82));
      box-shadow: 0 16px 34px rgba(80,120,255,0.22);
      cursor:pointer;
    }
    .startBtn:active{ transform: translateY(1px); }
  </style>
</head>

<body>
  <div class="app">
    <header class="hud">
      <div class="hudLeft">
        <div class="title">送り仮名 落ちゲー（簡単）</div>
        <div class="sub">落ち切る前に「正しいかな」をタップ</div>
      </div>
      <div class="hudRight">
        <div class="row">SCORE<b id="scoreTxt">0</b></div>
        <div class="row">STREAK<b id="streakTxt">0</b></div>
        <div class="row">LIFE<b id="lifeTxt">3</b></div>
      </div>
    </header>

    <main class="field" id="field">
      <div class="catchLine"></div>
      <div class="catchLabel">ここまでに答える</div>

      <div class="toast" id="toast"></div>

      <div class="falling" id="falling">
        <div class="card">
          <div class="qText" id="qText">　</div>
          <div class="qHint" id="qHint">下の答えをタップ</div>
        </div>
      </div>

      <div class="overlay" id="overlay">
        <div class="overlayCard">
          <div class="big" id="overlayTitle">スタート</div>
          <div class="desc" id="overlayDesc">
            問題が落ち切る前に、下の3択から正しい送り仮名をタップしてください。<br/>
            間違い or 時間切れでライフが減ります。
          </div>
          <button class="startBtn" id="startBtn">開始</button>
        </div>
      </div>
    </main>

    <footer class="choices">
      <div class="choiceRow">
        <button class="choiceBtn" id="c0">-</button>
        <button class="choiceBtn" id="c1">-</button>
        <button class="choiceBtn" id="c2">-</button>
      </div>
      <div class="smallRow">
        <div class="chip" id="statusChip">速度: ゆっくり</div>
        <button class="miniBtn" id="pauseBtn">一時停止</button>
        <button class="miniBtn" id="resetBtn">リセット</button>
      </div>
    </footer>
  </div>

  <script>
    /* 出題（まずは分かりやすいものだけ） */
    var QUESTIONS = [
      
        { display: "理解",   correct: "りかい",   wrong: ["りけい","りがい"] },
  { display: "改善",   correct: "かいぜん", wrong: ["かいせん","かいざん"] },
  { display: "必要",   correct: "ひつよう", wrong: ["ひっよう","ひつやく"] },
  { display: "準備",   correct: "じゅんび", wrong: ["じゅんぴ","しゅんび"] },
  { display: "結果",   correct: "けっか",   wrong: ["けつか","けっが"] },

  { display: "予想",   correct: "よそう",   wrong: ["よぞう","ようそう"] },
  { display: "影響",   correct: "えいきょう", wrong: ["えきょう","けいきょう"] },
  { display: "対象",   correct: "たいしょう", wrong: ["だいしょう","たいぞう"] },
  { display: "協力",   correct: "きょうりょく", wrong: ["きょうりく","きょうろく"] },
  { display: "詳細",   correct: "しょうさい", wrong: ["しょうざい","じょうさい"] },

  { display: "確認",   correct: "かくにん", wrong: ["かくねん","かっくにん"] },
  { display: "提案",   correct: "ていあん", wrong: ["ていなん","たいあん"] },
  { display: "実施",   correct: "じっし",   wrong: ["じつし","じっせ"] },
  { display: "状況",   correct: "じょうきょう", wrong: ["じょきょう","しょうきょう"] },
  { display: "計画",   correct: "けいかく", wrong: ["けいがく","けいかつ"] },

  { display: "参加",   correct: "さんか",   wrong: ["さんが","さんけ"] },
  { display: "連絡",   correct: "れんらく", wrong: ["れんりゃく","れんろく"] },
  { display: "増加",   correct: "ぞうか",   wrong: ["そうか","ぞうが"] },
  { display: "減少",   correct: "げんしょう", wrong: ["げんじょう","げんぞう"] },
  { display: "成功",   correct: "せいこう", wrong: ["せいごう","しょうこう"] },

  { display: "失敗",   correct: "しっぱい", wrong: ["しつぱい","しんぱい"] },
  { display: "努力",   correct: "どりょく", wrong: ["どりく","どりょう"] },
  { display: "緊張",   correct: "きんちょう", wrong: ["きんしょう","きんじょう"] },
  { display: "判断",   correct: "はんだん", wrong: ["はんたん","ばんだん"] },
  { display: "発言",   correct: "はつげん", wrong: ["はっげん","はつけん"] },

  { display: "証明",   correct: "しょうめい", wrong: ["せいめい","しょうみょう"] },
  { display: "関係",   correct: "かんけい", wrong: ["かんげい","かんけ"] },
  { display: "現在",   correct: "げんざい", wrong: ["げんさい","けんざい"] },
  { display: "将来",   correct: "しょうらい", wrong: ["しょうれい","そうらい"] },
  { display: "世紀",   correct: "せいき",   wrong: ["せき","せいぎ"] },

  { display: "伝統",   correct: "でんとう", wrong: ["てんとう","でんどう"] },
  { display: "科学",   correct: "かがく",   wrong: ["かくが","かごく"] },
  { display: "技術",   correct: "ぎじゅつ", wrong: ["きじゅつ","ぎじつ"] },
  { display: "文化",   correct: "ぶんか",   wrong: ["もんか","ぶんが"] },
  { display: "経済",   correct: "けいざい", wrong: ["けいさい","きょうざい"] },

  { display: "貿易",   correct: "ぼうえき", wrong: ["ぼういき","ほうえき"] },
  { display: "政治",   correct: "せいじ",   wrong: ["せいし","しょうじ"] },
  { display: "法律",   correct: "ほうりつ", wrong: ["ほうりち","ほうれつ"] },
  { display: "議論",   correct: "ぎろん",   wrong: ["きろん","ぎりん"] },
  { display: "承認",   correct: "しょうにん", wrong: ["じょうにん","しょうりん"] },

  { display: "適切",   correct: "てきせつ", wrong: ["てきぜつ","できせつ"] },
  { display: "危険",   correct: "きけん",   wrong: ["ぎけん","きがん"] },
  { display: "安全",   correct: "あんぜん", wrong: ["あんせん","あんぜい"] },
  { display: "健康",   correct: "けんこう", wrong: ["けんごう","きんこう"] },
  { display: "食品",   correct: "しょくひん", wrong: ["しょくびん","そくひん"] },

  { display: "環境",   correct: "かんきょう", wrong: ["かんけい","かんぎょう"] },
  { display: "地域",   correct: "ちいき",   wrong: ["ちえき","じいき"] },
  { display: "交通",   correct: "こうつう", wrong: ["こうづう","こうとう"] },
  { display: "事故",   correct: "じこ",     wrong: ["しこ","じご"] },
  { display: "救助",   correct: "きゅうじょ", wrong: ["きゅうしょ","きゅうじゅ"] },
  
   { display: "顕著",   correct: "けんちょ",   wrong: ["けんしょ","けんちゅ"] },
  { display: "措置",   correct: "そち",       wrong: ["しょち","そうち"] },
  { display: "概念",   correct: "がいねん",   wrong: ["かいねん","がいめん"] },
  { display: "吟味",   correct: "ぎんみ",     wrong: ["きんみ","ぎんび"] },
  { display: "把握",   correct: "はあく",     wrong: ["はくあ","ばあく"] },

  { display: "妥当",   correct: "だとう",     wrong: ["たとう","だどう"] },
  { display: "遵守",   correct: "じゅんしゅ", wrong: ["じゅんす","しゅんしゅ"] },
  { display: "是正",   correct: "ぜせい",     wrong: ["ぜいせい","せせい"] },
  { display: "根拠",   correct: "こんきょ",   wrong: ["こんこ","こんけい"] },
  { display: "見解",   correct: "けんかい",   wrong: ["けんがい","げんかい"] },

  { display: "懸念",   correct: "けねん",     wrong: ["けんねん","けれん"] },
  { display: "模索",   correct: "もさく",     wrong: ["もさつ","もさっ"] },
  { display: "促進",   correct: "そくしん",   wrong: ["しょくしん","そっしん"] },
  { display: "精査",   correct: "せいさ",     wrong: ["せいしゃ","しょうさ"] },
  { display: "担保",   correct: "たんぽ",     wrong: ["たんぼ","だんぽ"] },

  { display: "抽象",   correct: "ちゅうしょう", wrong: ["ちゅしょう","ちゅうぞう"] },
  { display: "優遇",   correct: "ゆうぐう",   wrong: ["ゆうきゅう","ゆうぐ"] },
  { display: "抑制",   correct: "よくせい",   wrong: ["おくせい","よくさい"] },
  { display: "訂正",   correct: "ていせい",   wrong: ["ていしょう","てせい"] },
  { display: "誤差",   correct: "ごさ",       wrong: ["こさ","ごしゃ"] },

  { display: "逸脱",   correct: "いつだつ",   wrong: ["いったつ","いつたつ"] },
  { display: "偏見",   correct: "へんけん",   wrong: ["へんげん","へいけん"] },
  { display: "傾向",   correct: "けいこう",   wrong: ["けんこう","けいごう"] },
  { display: "紛争",   correct: "ふんそう",   wrong: ["ふんそう(濁音なし)","ふんぞう"] },
  { display: "統治",   correct: "とうち",     wrong: ["とうじ","とおち"] },

  { display: "施策",   correct: "しさく",     wrong: ["しさっ","せさく"] },
  { display: "審査",   correct: "しんさ",     wrong: ["しんざ","じんさ"] },
  { display: "迅速",   correct: "じんそく",   wrong: ["しんそく","じんぞく"] },
  { display: "慎重",   correct: "しんちょう", wrong: ["しんじょう","しんちょ"] },
  { display: "緩和",   correct: "かんわ",     wrong: ["がんわ","かんば"] },

  { display: "妨害",   correct: "ぼうがい",   wrong: ["ほうがい","ぼうけい"] },
  { display: "譲歩",   correct: "じょうほ",   wrong: ["じょうぶ","しょうほ"] },
  { display: "補償",   correct: "ほしょう",   wrong: ["ほそう","ほじょう"] },
  { display: "賠償",   correct: "ばいしょう", wrong: ["はいしょう","ばいそう"] },
  { display: "損害",   correct: "そんがい",   wrong: ["そんけい","そんだい"] },

  { display: "徴収",   correct: "ちょうしゅう", wrong: ["ちょうじゅう","ちょうしゅ"] },
  { display: "免除",   correct: "めんじょ",   wrong: ["めんしょ","めんじゅ"] },
  { display: "履歴",   correct: "りれき",     wrong: ["りりき","れきれき"] },
  { display: "崩壊",   correct: "ほうかい",   wrong: ["くずかい","ほうがい"] },
  { display: "概略",   correct: "がいりゃく", wrong: ["がいらく","かいりゃく"] },

  { display: "即座",   correct: "そくざ",     wrong: ["そくさ","しょくざ"] },
  { display: "堅実",   correct: "けんじつ",   wrong: ["かたじつ","けいじつ"] },
  { display: "到達",   correct: "とうたつ",   wrong: ["どうたつ","とうだつ"] },
  { display: "継続",   correct: "けいぞく",   wrong: ["けいそく","けいづく"] },
  { display: "推移",   correct: "すいい",     wrong: ["すい", "すいえい"] },

  { display: "顧問",   correct: "こもん",     wrong: ["くもん","こぼん"] },
  { display: "奨励",   correct: "しょうれい", wrong: ["しょうりょう","しょうらい"] },
  { display: "自粛",   correct: "じしゅく",   wrong: ["じしゅう","ししゅく"] },
  { display: "慈善",   correct: "じぜん",     wrong: ["しぜん","じせん"] },
  { display: "脅威",   correct: "きょうい",   wrong: ["きょい","きょうえい"] },
  
    { display: "憂慮",   correct: "ゆうりょ",   wrong: ["ゆうろ","ゆりょ"] },
  { display: "払拭",   correct: "ふっしょく", wrong: ["ふつしょく","はらしょく"] },
  { display: "看過",   correct: "かんか",     wrong: ["かんが","けんか"] },
  { display: "黙認",   correct: "もくにん",   wrong: ["もくねん","ぼくにん"] },
  { display: "検証",   correct: "けんしょう", wrong: ["けんせい","けんじょう"] },

  { display: "踏襲",   correct: "とうしゅう", wrong: ["ふしゅう","とうしゅ"] },
  { display: "示唆",   correct: "しさ",       wrong: ["ししゃ","じさ"] },
  { display: "斡旋",   correct: "あっせん",   wrong: ["あつせん","あっぜん"] },
  { display: "醸成",   correct: "じょうせい", wrong: ["じょうせん","しょうせい"] },
  { display: "捏造",   correct: "ねつぞう",   wrong: ["ねっそう","でつぞう"] },

  { display: "恣意",   correct: "しい",       wrong: ["しぎ","じい"] },
  { display: "誹謗",   correct: "ひぼう",     wrong: ["ひぼ","ひもう"] },
  { display: "中傷",   correct: "ちゅうしょう", wrong: ["ちゅしょう","ちゅうじょう"] },
  { display: "稟議",   correct: "りんぎ",     wrong: ["りんき","ひんぎ"] },
  { display: "折衝",   correct: "せっしょう", wrong: ["おっしょう","せつしょう"] },

  { display: "渉外",   correct: "しょうがい", wrong: ["しょうげ","しょうかい"] },
  { display: "精緻",   correct: "せいち",     wrong: ["せいし","しょうち"] },
  { display: "端緒",   correct: "たんしょ",   wrong: ["たんちょ","だんしょ"] },
  { display: "帰趨",   correct: "きすう",     wrong: ["きしゅ","きす"] },
  { display: "趨勢",   correct: "すうせい",   wrong: ["しゅせい","すせい"] },

  { display: "逼迫",   correct: "ひっぱく",   wrong: ["ひつぱく","ひょっぱく"] },
  { display: "逼塞",   correct: "ひっそく",   wrong: ["ひっそ","ひつそく"] },
  { display: "払底",   correct: "ふってい",   wrong: ["ふって","はらてい"] },
  { display: "逼真",   correct: "ひっしん",   wrong: ["ひっじん","ひつしん"] },
  { display: "緻密",   correct: "ちみつ",     wrong: ["ちみつ(濁音なし)","しみつ"] },

  { display: "瑕疵",   correct: "かし",       wrong: ["かじ","けし"] },
  { display: "毀損",   correct: "きそん",     wrong: ["ぎそん","きざん"] },
  { display: "罹患",   correct: "りかん",     wrong: ["りがん","れいかん"] },
  { display: "漸進",   correct: "ぜんしん",   wrong: ["ざんしん","ぜんじん"] },
  { display: "刹那",   correct: "せつな",     wrong: ["さつな","せつね"] },

  { display: "矯正",   correct: "きょうせい", wrong: ["きょせい","きょうさい"] },
  { display: "矯激",   correct: "きょうげき", wrong: ["きょうき","きょげき"] },
  { display: "慫慂",   correct: "しょうよう", wrong: ["そうよう","しょうゆう"] },
  { display: "蹂躙",   correct: "じゅうりん", wrong: ["じゅりん","しゅうりん"] },
  { display: "慟哭",   correct: "どうこく",   wrong: ["とうこく","どうごく"] },

  { display: "倨傲",   correct: "きょごう",   wrong: ["こごう","きょうごう"] },
  { display: "桎梏",   correct: "しっこく",   wrong: ["てつこく","しつこく"] },
  { display: "逡巡",   correct: "しゅんじゅん", wrong: ["しゅんじゅ","すんじゅん"] },
  { display: "蹉跌",   correct: "さてつ",     wrong: ["さてっ","さてい"] },
  { display: "憔悴",   correct: "しょうすい", wrong: ["しょうさい","しょうずい"] },

  { display: "慇懃",   correct: "いんぎん",   wrong: ["いんけん","えんぎん"] },
  { display: "慄然",   correct: "りつぜん",   wrong: ["りっぜん","りつねん"] },
  { display: "慟然",   correct: "どうぜん",   wrong: ["とうぜん","どうねん"] },
  { display: "狼狽",   correct: "ろうばい",   wrong: ["ろうはい","ろうべい"] },
  { display: "憂鬱",   correct: "ゆううつ",   wrong: ["ゆうつ","ゆういつ"] },

  { display: "饒舌",   correct: "じょうぜつ", wrong: ["にょうぜつ","じょうせつ"] },
  { display: "慳貪",   correct: "けんどん",   wrong: ["けんたん","かんどん"] },
  { display: "矜持",   correct: "きょうじ",   wrong: ["きんじ","こんじ"] },
  { display: "刮目",   correct: "かつもく",   wrong: ["かっもく","かつめ"] },
  { display: "僥倖",   correct: "ぎょうこう", wrong: ["きょうこう","ぎょうこ"] }
      
      { 
    ];

    var field = document.getElementById("field");
    var falling = document.getElementById("falling");
    var qText = document.getElementById("qText");

    var c0 = document.getElementById("c0");
    var c1 = document.getElementById("c1");
    var c2 = document.getElementById("c2");
    var btns = [c0, c1, c2];

    var scoreTxt = document.getElementById("scoreTxt");
    var streakTxt = document.getElementById("streakTxt");
    var lifeTxt = document.getElementById("lifeTxt");
    var statusChip = document.getElementById("statusChip");

    var toast = document.getElementById("toast");

    var overlay = document.getElementById("overlay");
    var overlayTitle = document.getElementById("overlayTitle");
    var overlayDesc = document.getElementById("overlayDesc");
    var startBtn = document.getElementById("startBtn");

    var pauseBtn = document.getElementById("pauseBtn");
    var resetBtn = document.getElementById("resetBtn");

    var score = 0;
    var streak = 0;
    var life = 3;

    var running = false;
    var paused = false;
    var answered = false;

    var fallY = -60;
    var catchY = 0;

    // 速度（簡単版は固定でゆっくり）
    var speed = 2.0; // px/frame

    var correct = "";
    var lastFrame = 0;

    function randInt(n){ return Math.floor(Math.random() * n); }

    function shuffle(arr){
      var a = arr.slice();
      for (var i = a.length - 1; i > 0; i--){
        var j = randInt(i + 1);
        var t = a[i]; a[i] = a[j]; a[j] = t;
      }
      return a;
    }

    function showToast(text, ok){
      toast.textContent = text;
      toast.className = "toast " + (ok ? "ok" : "ng") + " show";
      setTimeout(function(){ toast.className = "toast"; }, 880);
    }

    function setButtonsEnabled(on){
      for (var i=0;i<btns.length;i++){
        if (on){
          btns[i].className = "choiceBtn";
          btns[i].disabled = false;
        } else {
          btns[i].className = "choiceBtn disabled";
          btns[i].disabled = true;
        }
      }
    }

    function renderHud(){
      scoreTxt.textContent = String(score);
      streakTxt.textContent = String(streak);
      lifeTxt.textContent = String(life);
      statusChip.textContent = "速度: ゆっくり";
      pauseBtn.textContent = paused ? "再開" : "一時停止";
    }

    function layout(){
      // 判定ライン: bottom 112px → field内のY座標に変換
      // fallingのカードがこのYを超えたらタイムアウト扱い
      var h = field.clientHeight;
      catchY = h - 112 - 40; // ざっくり中央基準（カード高さの半分程度）
    }

    function spawn(){
      var q = QUESTIONS[randInt(QUESTIONS.length)];
      correct = q.correct;

      var opts = shuffle([q.correct, q.wrong[0], q.wrong[1]]);
      qText.textContent = q.display;

      c0.textContent = opts[0];
      c1.textContent = opts[1];
      c2.textContent = opts[2];

      fallY = -60;
      falling.style.top = fallY + "px";

      answered = false;
      setButtonsEnabled(true);
      renderHud();
    }

    function nextAfter(ms){
      setButtonsEnabled(false);
      setTimeout(function(){
        if (!running) return;
        spawn();
      }, ms);
    }

    function judge(tapped){
      if (!running || paused || answered) return;
      answered = true;

      if (tapped === correct){
        streak += 1;
        var gain = 10 + Math.min(20, streak); // 連続でちょい増し
        score += gain;
        showToast("正解 +" + gain, true);
      } else {
        streak = 0;
        life -= 1;
        showToast("不正解 -1", false);
      }

      renderHud();

      if (life <= 0){
        gameOver();
        return;
      }

      nextAfter(420);
    }

    function timeout(){
      if (!running || paused || answered) return;
      answered = true;
      streak = 0;
      life -= 1;
      showToast("時間切れ -1", false);
      renderHud();

      if (life <= 0){
        gameOver();
        return;
      }
      nextAfter(420);
    }

    function loop(ts){
      if (!running) return;
      if (!lastFrame) lastFrame = ts;
      lastFrame = ts;

      if (!paused && !answered){
        fallY += speed;
        falling.style.top = fallY + "px";
        if (fallY >= catchY){
          timeout();
        }
      }
      requestAnimationFrame(loop);
    }

    function start(){
      score = 0;
      streak = 0;
      life = 3;
      paused = false;
      running = true;
      overlay.style.display = "none";
      lastFrame = 0;

      layout();
      spawn();
      requestAnimationFrame(loop);
    }

    function gameOver(){
      running = false;
      paused = false;
      setButtonsEnabled(false);

      overlayTitle.textContent = "ゲームオーバー";
      overlayDesc.innerHTML = "SCORE: <b>" + score + "</b><br/>もう一度やる場合は開始を押してください。";
      startBtn.textContent = "もう一度";
      overlay.style.display = "grid";
    }

    function resetAll(){
      running = false;
      paused = false;
      answered = false;
      setButtonsEnabled(false);

      overlayTitle.textContent = "スタート";
      overlayDesc.innerHTML =
        "問題が落ち切る前に、下の3択から正しい送り仮名をタップしてください。<br/>間違い or 時間切れでライフが減ります。";
      startBtn.textContent = "開始";
      overlay.style.display = "grid";

      qText.textContent = "　";
      c0.textContent = "-"; c1.textContent = "-"; c2.textContent = "-";
      fallY = -60; falling.style.top = fallY + "px";

      score = 0; streak = 0; life = 3;
      renderHud();
    }

    // 入力：3択タップのみ
    c0.addEventListener("click", function(){ judge(c0.textContent); });
    c1.addEventListener("click", function(){ judge(c1.textContent); });
    c2.addEventListener("click", function(){ judge(c2.textContent); });

    pauseBtn.addEventListener("click", function(){
      if (!running) return;
      paused = !paused;
      renderHud();
    });

    resetBtn.addEventListener("click", function(){
      resetAll();
    });

    startBtn.addEventListener("click", function(){
      start();
    });

    window.addEventListener("resize", function(){
      layout();
    });

    // 初期化
    layout();
    setButtonsEnabled(false);
    renderHud();
  </script>
</body>
</html>